<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Parade - Whitmo + Niko With K</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Parade by Whitmo + Niko With K.">
    <meta name="theme-color" content="#10413D">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- Open Graph / Facebook / Discord -->
    <meta property="og:type" content="music.album">
    <meta property="og:title" content="Parade - Whitmo + Niko With K">
    <meta property="og:description" content="Parade by Whitmo + Niko With K. Check out our album!">
    <meta property="og:image" content="/favicon.png">
    <meta property="og:url" content="https://album-1-henna.vercel.app">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Parade - Whitmo + Niko With K">
    <meta name="twitter:description" content="Parade by Whitmo + Niko With K. Check out our album!">
    <meta name="twitter:image" content="/favicon.png">
    
    <link rel="stylesheet" href="https://unpkg.com/98.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: "MS Sans Serif", sans-serif;
        overflow: hidden;
        min-height: 100vh;
        user-select: none;
      }
      
      /* Windows 98 Desktop Background */
      #desktop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: calc(100vh - 28px); /* Account for taskbar */
        background-color: #10413D;
        background-image: url('./background.webp');
        background-size: auto 100%;
        background-position: center;
        background-repeat: no-repeat;
      }
      
        /*background-image: 
          repeating-linear-gradient(
            0deg,
            transparent,
            transparent 2px,
            rgba(0, 0, 0, 0.03) 2px,
            rgba(0, 0, 0, 0.03) 4px
          ),
          repeating-linear-gradient(
            90deg,
            transparent,
            transparent 2px,
            rgba(0, 0, 0, 0.03) 2px,
            rgba(0, 0, 0, 0.03) 4px
          );
      }
      }
      /* Desktop Icons */
      .desktop-icon {
        position: absolute;
        width: 80px;
        text-align: center;
        cursor: pointer;
        padding: 4px;
      }
      
      .desktop-icon:hover {
        background: rgba(0, 0, 128, 0.3);
        outline: 1px dotted #000;
      }
      
      .desktop-icon img {
        width: 32px;
        height: 32px;
        margin-bottom: 4px;
        image-rendering: pixelated;
      }
      
      .desktop-icon span {
        display: block;
        color: white;
        text-shadow: 1px 1px 1px black;
        font-size: 11px;
        word-wrap: break-word;
      }
      
      /* Webamp Container */
      #app {
        position: absolute;
        top: 60%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 10;
      }
      
      /* Fix Webamp overflow issue */
      #webamp {
        overflow: visible !important;
      }
      
      /* Fix for middle section protrusion */
      #webamp .window {
        overflow: visible !important;
      }
      
      /* Ensure Webamp components don't have unwanted overflow */
      #webamp #equalizer-window,
      #webamp #playlist-window {
        overflow: visible !important;
      }
      
      /* Windows 98 Taskbar */
      .taskbar {
          position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 28px;
        background-color: #c0c0c0;
        border-top: 2px solid #ffffff;
        display: flex;
        align-items: center;
        z-index: 100;
        }
        
      .start-button {
        height: 22px;
        margin: 0 2px;
        padding: 0 4px;
        min-width: 54px;
        font-weight: bold;
        font-size: 11px;
        display: flex;
        align-items: center;
        gap: 4px;
        }
        
      .start-icon {
        width: 16px;
        height: 16px;
        background-image: url('./icons/start.png');
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        image-rendering: pixelated;
      }
        
      .taskbar-clock {
        margin-left: auto;
        margin-right: 8px;
        padding: 0 8px;
        height: 22px;
        display: flex;
        align-items: center;
        border: 1px inset #c0c0c0;
        background: #c0c0c0;
        font-size: 11px;
      }

      /* Start Menu */
      .start-menu {
        display: none;
        position: fixed;
        bottom: 30px;
        left: 2px;
        width: 200px;
        background-color: #c0c0c0;
        border: 2px outset #ffffff;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        font-size: 11px;
      }

      .start-menu.active {
        display: block;
      }

      .start-menu-sidebar {
        display: none;
      }

      .start-menu-items {
        padding: 2px;
      }

      .start-menu-item {
        display: flex;
        align-items: center;
        padding: 6px 8px;
        cursor: pointer;
        text-decoration: none;
        color: black;
        gap: 8px;
        font-size: 11px;
      }

      .start-menu-item:hover {
        background-color: #000080;
        color: white;
      }

      .start-menu-item .emoji {
        font-size: 16px;
        width: 20px;
      }

      /* About Window (hidden by default) */
      .about-window, .links-window, .inspiration-window, .paint-window {
        display: none;
        position: absolute;
        z-index: 50;
      }

      .about-window {
        top: 80px;
        left: 80px;
      }

      .links-window {
        top: 120px;
        left: 200px;
      }

      .inspiration-window {
        top: 160px;
        left: 320px;
      }

      /* Paint Window - positioned to the right of Webamp */
      .paint-window {
        top: 50%;
        left: 50%;
        transform: translate(calc(-50% + 275px + 20px), -50%);
        /* Positioned: center + (Webamp width / 2) + spacing */
      }

      .about-window.active, .links-window.active, .inspiration-window.active, .paint-window.active {
        display: block;
      }
      
      /* Fix window body styling for proper contrast */
      .window-body {
        background-color: white !important;
        color: black !important;
        font-family: "MS Sans Serif", Tahoma, sans-serif;
        font-size: 11px;
      }
      
      /* Note field styling */
      .note-content {
        font-family: "Courier New", monospace;
        font-size: 13px;
        line-height: 1.4;
        white-space: pre-wrap;
        background-color: white;
        color: black;
        padding: 8px;
      }
      
      /* Ensure consistent heading styles */
      .window-body h3, .window-body h4 {
        font-family: "MS Sans Serif", Tahoma, sans-serif;
        font-size: 11px;
        font-weight: bold;
        margin: 0 0 8px 0;
      }
      
      /* Make title bars draggable cursor */
      .title-bar {
        cursor: move;
      }
      
      /* Links list styling */
      .links-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      
      .links-list li {
        margin: 8px 0;
      }
      
      .links-list a {
        color: #0000FF;
        text-decoration: underline;
      }
      
      /* Inspiration videos */
      .inspiration-list {
        max-height: 300px;
        overflow-y: auto;
      }
      
      .inspiration-item {
        margin-bottom: 16px;
        padding-bottom: 16px;
        border-bottom: 1px solid #c0c0c0;
      }
      
      .inspiration-item:last-child {
        border-bottom: none;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        #app {
          transform: translate(-50%, -50%) scale(0.8);
        }
        
        .desktop-icon {
          width: 60px;
        }
        
        .desktop-icon img {
          width: 24px;
          height: 24px;
        }
        
        .desktop-icon span {
          font-size: 10px;
        }
        
        /* Make windows responsive on mobile */
        .window {
          max-width: calc(100vw - 20px) !important;
          max-height: calc(100vh - 60px) !important;
        }
        
        /* Adjust window positions for mobile */
        .about-window,
        .links-window,
        .inspiration-window {
          left: 10px !important;
          top: 10px !important;
        }
        
        /* Paint window specific adjustments */
        .paint-window {
          top: 10px !important;
          left: 10px !important;
          transform: none !important;
        }
        
        .paint-window .window {
          width: calc(100vw - 20px) !important;
          height: calc(100vh - 60px) !important;
        }
        
        /* Make window content scrollable if needed */
        .window-body {
          overflow: auto;
          max-height: calc(100vh - 100px);
        }
      }
    </style>
  </head>

  <body>
    <div id="desktop">
      <!-- Desktop Icons -->
      <div class="desktop-icon" style="top: 20px; left: 20px;" onclick="toggleWindow('about')">
        <img src="./icons/About This.png" alt="About This">
        <span>About This</span>
      </div>
      
      <div class="desktop-icon" style="top: 120px; left: 20px;" onclick="toggleWindow('links')">
        <img src="./icons/Links.png" alt="Links">
        <span>Links</span>
      </div>
      
      <div class="desktop-icon" style="top: 220px; left: 20px;" onclick="toggleWindow('inspiration')">
        <img src="./icons/Inspiration.png" alt="Inspiration">
        <span>Inspiration</span>
      </div>

      <div class="desktop-icon" style="top: 320px; left: 20px;" onclick="toggleWindow('paint')">
        <img src="./icons/paint.webp" alt="Paint">
        <span>Paint</span>
      </div>

      <!-- About Window -->
      <div class="about-window" id="aboutWindow">
        <div class="window" style="width: 400px">
          <div class="title-bar">
            <div class="title-bar-text">About This Album</div>
            <div class="title-bar-controls">
              <button aria-label="Close" onclick="toggleWindow('about')"></button>
            </div>
          </div>
          <div class="window-body" id="about-content">
            <!-- Content loaded from content/about.md -->
          </div>
        </div>
      </div>
      
      <!-- Links Window -->
      <div class="links-window" id="linksWindow">
        <div class="window" style="width: 300px">
          <div class="title-bar">
            <div class="title-bar-text">Links</div>
            <div class="title-bar-controls">
              <button aria-label="Close" onclick="toggleWindow('links')"></button>
            </div>
          </div>
          <div class="window-body" id="links-content">
            <!-- Content loaded from content/links.md -->
          </div>
        </div>
      </div>
      
      <!-- Inspiration Window -->
      <div class="inspiration-window" id="inspirationWindow">
        <div class="window" style="width: 500px">
          <div class="title-bar">
            <div class="title-bar-text">Inspiration</div>
            <div class="title-bar-controls">
              <button aria-label="Close" onclick="toggleWindow('inspiration')"></button>
            </div>
          </div>
          <div class="window-body" id="inspiration-content">
            <!-- Content loaded from content/inspiration.md -->
          </div>
        </div>
      </div>

      <!-- Paint Window -->
      <div class="paint-window" id="paintWindow">
        <div class="window" style="width: 850px; height: 650px;">
          <div class="title-bar">
            <div class="title-bar-text">Paint</div>
            <div class="title-bar-controls">
              <button aria-label="Close" onclick="toggleWindow('paint')"></button>
            </div>
          </div>
          <div class="window-body" style="padding: 0; margin: 0; height: calc(100% - 18px); overflow: hidden;">
            <iframe src="https://jspaint.app" frameborder="0" style="width: 100%; height: 100%; border: none; display: block;"></iframe>
          </div>
        </div>
      </div>

      <!-- Webamp Player -->
      <div id="app">
        <!-- Webamp will render here -->
      </div>
      </div>
      
    <!-- Windows 98 Taskbar -->
    <div class="taskbar">
      <button class="start-button" id="start-button">
        <div class="start-icon"></div>
        Start
      </button>
      <div class="taskbar-clock" id="clock">12:00 PM</div>
    </div>

    <!-- Start Menu -->
    <div id="start-menu" class="start-menu">
      <div class="start-menu-sidebar">
        <span>Windows<br>98</span>
      </div>
      <div class="start-menu-items" id="start-menu-items">
        <!-- Menu items loaded dynamically from links.md -->
      </div>
    </div>

    <script src="https://unpkg.com/webamp@1.4.2/built/webamp.bundle.min.js"></script>
    <script>
      // Initialize Webamp
      const Webamp = window.Webamp;
      const webamp = new Webamp({
        initialTracks: [
          {
            metaData: {
              artist: "Whitmo, Niko With K",
              title: "Parade",
              album: "Self titled"
            },
            url: "./music/Parade.wav",
            duration: 150, // 2:30
          },
          {
            metaData: {
              artist: "Whitmo, Niko With K",
              title: "Marusa is sneezing",
              album: "Self titled"
            },
            url: "./music/Marusa is sneezing.wav",
            duration: 145, // 2:25
          },
          {
            metaData: {
              artist: "Whitmo, Niko With K",
              title: "The Boiler",
              album: "Self titled"
            },
            url: "./music/The Boiler.wav",
            duration: 216, // 3:36
          },
          {
            metaData: {
              artist: "Whitmo, Niko With K",
              title: "Crazy Cat",
              album: "Self titled"
            },
            url: "./music/Crazy Cat.wav",
            duration: 170, // 2:50
          },
          {
            metaData: {
              artist: "Whitmo, Niko With K",
              title: "Mukha",
              album: "Self titled"
            },
            url: "./music/Mukha.wav",
            duration: 163, // 2:43
          }
        ],
      });

      webamp.renderWhenReady(document.getElementById("app"));
      
      // Toggle Window - Modified to allow multiple windows
      function toggleWindow(windowType) {
        const windows = {
          'about': document.getElementById('aboutWindow'),
          'links': document.getElementById('linksWindow'),
          'inspiration': document.getElementById('inspirationWindow'),
          'paint': document.getElementById('paintWindow')
        };

        const targetWindow = windows[windowType];

        // Simply toggle the target window without closing others
        if (targetWindow.classList.contains('active')) {
          targetWindow.classList.remove('active');
        } else {
          targetWindow.classList.add('active');
          // Bring to front
          targetWindow.style.zIndex = getHighestZIndex() + 1;
        }
      }

      // Helper function to get the highest z-index
      function getHighestZIndex() {
        const elements = document.querySelectorAll('.about-window, .links-window, .inspiration-window, .paint-window');
        let highest = 50;
        elements.forEach(el => {
          const zIndex = parseInt(window.getComputedStyle(el).zIndex) || 0;
          if (zIndex > highest) highest = zIndex;
        });
        return highest;
      }
      
      // Make windows come to front when clicked
      function bringToFront(windowElement) {
        windowElement.addEventListener('mousedown', function() {
          this.style.zIndex = getHighestZIndex() + 1;
        });
      }
      
      // Update clock
      function updateClock() {
        const now = new Date();
        const hours = now.getHours();
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const ampm = hours >= 12 ? 'PM' : 'AM';
        const displayHours = hours % 12 || 12;
        document.getElementById('clock').textContent = `${displayHours}:${minutes} ${ampm}`;
      }
      
      updateClock();
      setInterval(updateClock, 60000);
      
      // Start Menu functionality
      function toggleStartMenu() {
        const startMenu = document.getElementById('start-menu');
        startMenu.classList.toggle('active');
      }

      // Close Start menu when clicking outside
      document.addEventListener('click', function(event) {
        const startMenu = document.getElementById('start-menu');
        const startButton = document.getElementById('start-button');

        if (!startMenu.contains(event.target) && !startButton.contains(event.target)) {
          startMenu.classList.remove('active');
        }
      });

      // Start button click handler
      document.getElementById('start-button').addEventListener('click', function(event) {
        event.stopPropagation();
        toggleStartMenu();
      });
      
      // Make windows draggable
      function makeDraggable(windowElement) {
        const titleBar = windowElement.querySelector('.title-bar');
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;
        
        function dragStart(e) {
          if (e.target === titleBar || titleBar.contains(e.target)) {
            // Don't start drag if clicking the close button
            if (e.target.getAttribute('aria-label') === 'Close') {
              return;
            }
            
            isDragging = true;
            
            if (e.type === "touchstart") {
              initialX = e.touches[0].clientX - xOffset;
              initialY = e.touches[0].clientY - yOffset;
            } else {
              initialX = e.clientX - xOffset;
              initialY = e.clientY - yOffset;
            }
            
            windowElement.style.zIndex = 1000; // Bring to front
          }
        }
        
        function dragEnd(e) {
          initialX = currentX;
          initialY = currentY;
          isDragging = false;
          windowElement.style.zIndex = 50;
        }
        
        function drag(e) {
          if (isDragging) {
            e.preventDefault();
            
            if (e.type === "touchmove") {
              currentX = e.touches[0].clientX - initialX;
              currentY = e.touches[0].clientY - initialY;
            } else {
              currentX = e.clientX - initialX;
              currentY = e.clientY - initialY;
            }
            
            xOffset = currentX;
            yOffset = currentY;
            
            windowElement.style.transform = `translate(${currentX}px, ${currentY}px)`;
          }
        }
        
        // Mouse events
        titleBar.addEventListener('mousedown', dragStart);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', dragEnd);
        
        // Touch events for mobile
        titleBar.addEventListener('touchstart', dragStart);
        document.addEventListener('touchmove', drag);
        document.addEventListener('touchend', dragEnd);
      }

      // Load markdown content from files
      async function loadMarkdownContent(file, targetElementId) {
        try {
          const response = await fetch(`./content/${file}`);
          if (!response.ok) {
            throw new Error(`Failed to load ${file}`);
          }
          const markdown = await response.text();
          const html = marked.parse(markdown);
          document.getElementById(targetElementId).innerHTML = html;
        } catch (error) {
          console.error(`Error loading ${file}:`, error);
          document.getElementById(targetElementId).innerHTML = '<p>Error loading content.</p>';
        }
      }

      // Load links from links.md and populate Start Menu
      async function loadStartMenuLinks() {
        try {
          const response = await fetch('./content/links.md');
          if (!response.ok) {
            throw new Error('Failed to load links.md');
          }
          const markdown = await response.text();

          // Parse markdown to extract links
          const lines = markdown.split('\n');
          const menuItemsContainer = document.getElementById('start-menu-items');

          lines.forEach(line => {
            // Match markdown links with emoji: - ðŸŽµ [Spotify](https://spotify.com)
            const linkMatch = line.match(/^-\s*(\S+)\s*\[([^\]]+)\]\(([^)]+)\)/);
            if (linkMatch) {
              const emoji = linkMatch[1];
              const text = linkMatch[2];
              const url = linkMatch[3];

              // Create menu item
              const menuItem = document.createElement('a');
              menuItem.className = 'start-menu-item';
              menuItem.href = url;
              menuItem.target = '_blank';
              menuItem.innerHTML = `<span class="emoji">${emoji}</span><span>${text}</span>`;

              // Close menu when clicked
              menuItem.addEventListener('click', function() {
                document.getElementById('start-menu').classList.remove('active');
              });

              menuItemsContainer.appendChild(menuItem);
            }
          });
        } catch (error) {
          console.error('Error loading Start Menu links:', error);
        }
      }

      // Initialize draggable windows
      document.addEventListener('DOMContentLoaded', function() {
        const aboutWindow = document.getElementById('aboutWindow');
        const linksWindow = document.getElementById('linksWindow');
        const inspirationWindow = document.getElementById('inspirationWindow');
        const paintWindow = document.getElementById('paintWindow');

        makeDraggable(aboutWindow);
        makeDraggable(linksWindow);
        makeDraggable(inspirationWindow);
        makeDraggable(paintWindow);

        // Make windows come to front when clicked
        bringToFront(aboutWindow);
        bringToFront(linksWindow);
        bringToFront(inspirationWindow);
        bringToFront(paintWindow);

        // Load markdown content for windows
        loadMarkdownContent('about.md', 'about-content');
        loadMarkdownContent('links.md', 'links-content');
        loadMarkdownContent('inspiration.md', 'inspiration-content');

        // Load Start Menu links
        loadStartMenuLinks();
      });
    </script>
    
    <!-- Vercel Analytics -->
    <script>
      window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
  </body>
</html> 